# AutoDealerSphere 更新履歴 (2025年8月1日)

## 実装された機能

### 1. 車両データインポートの機能拡張

#### 「既存データを置き換える」オプションの追加
- **ファイル**: `Client/Pages/VehicleImport.razor`
- チェックボックスを追加して、既存データの置き換えオプションを提供
- チェックした場合、インポート前に既存の車両・顧客データをすべて削除

#### データ削除と連番リセット機能
- **ファイル**: `Server/Services/VehicleImportService.cs`
- 既存データ置き換え時の処理：
  1. 既存の車両データをすべて削除
  2. 車両テーブルのID連番をリセット（1から開始）
  3. 既存の顧客データをすべて削除
  4. 顧客テーブルのID連番をリセット（1から開始）

#### コントローラーの更新
- **ファイル**: `Server/Controllers/VehicleImportController.cs`
- `replaceExisting`パラメーターを受け取るように更新
- インポートサービスに置き換えオプションを渡す

### 2. ローディング画面の更新

#### ローディングスピナーの変更
- **ファイル**: `Client/wwwroot/index.html`
- BookOrderWasmプロジェクトと同じローディングスピナーに変更
- 8つのドットが円形に配置されたアニメーション
- 日本語メッセージ「ページを読み込んでいます... しばらくお待ちください。」
- エラーメッセージも日本語化

#### キャッシュ対策
- CSSファイルにバージョンパラメーターを追加（?v=2025080102）
- HTTPキャッシュ制御メタタグを追加

## 技術的な注意事項

### 静的ファイルの配信について
- Blazor WebAssemblyの開発環境では、静的ファイルは`Client/wwwroot`から直接配信される
- Static Web Assetsシステムにより、ビルド時の最適化が行われる
- 変更が反映されない場合は、ブラウザキャッシュのクリアが必要

### データベース操作
- SQLiteの`sqlite_sequence`テーブルを操作してID連番をリセット
- トランザクション内で削除処理を実行し、エラー時は適切にハンドリング

## 今後の課題
- index.htmlの変更が即座に反映されない問題の調査継続
- より効率的なキャッシュバスティング方法の検討