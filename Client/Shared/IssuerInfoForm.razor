@inject NavigationManager NavigationManager
@inject IJSRuntime JSRuntime
@using Syncfusion.Blazor.DataForm
@using Syncfusion.Blazor.Buttons
@using Syncfusion.Blazor.DropDowns
@using Syncfusion.Blazor.Inputs
@using System.ComponentModel.DataAnnotations

<div class="issuer-info-form">
	<EditForm Model="@Item" OnValidSubmit="OnValidated" OnInvalidSubmit="OnUnvalidated">
		<DataAnnotationsValidator />
		<div class="form">
			<h4>基本情報</h4>
			<div class="form-section">
			<div class="form-row">
				<label class="required">郵便番号</label>
				<SfTextBox @bind-Value="Item.PostalCode" Placeholder="郵便番号"></SfTextBox>
				<ValidationMessage For="@(() => Item.PostalCode)" />
			</div>
			<div class="form-row">
				<label class="required">社名</label>
				<SfTextBox @bind-Value="Item.CompanyName" Placeholder="社名"></SfTextBox>
				<ValidationMessage For="@(() => Item.CompanyName)" />
			</div>
			<div class="form-row">
				<label class="required">住所</label>
				<SfTextBox @bind-Value="Item.Address" Placeholder="住所"></SfTextBox>
				<ValidationMessage For="@(() => Item.Address)" />
			</div>
			<div class="form-row">
				<label>役職</label>
				<SfTextBox @bind-Value="Item.Position" Placeholder="役職"></SfTextBox>
				<ValidationMessage For="@(() => Item.Position)" />
			</div>
			<div class="form-row">
				<label class="required">氏名</label>
				<SfTextBox @bind-Value="Item.Name" Placeholder="氏名"></SfTextBox>
				<ValidationMessage For="@(() => Item.Name)" />
			</div>
			<div class="form-row">
				<label class="required">電話番号</label>
				<SfTextBox @bind-Value="Item.PhoneNumber" Placeholder="電話番号"></SfTextBox>
				<ValidationMessage For="@(() => Item.PhoneNumber)" />
			</div>
			<div class="form-row">
				<label>FAX番号</label>
				<SfTextBox @bind-Value="Item.FaxNumber" Placeholder="FAX番号"></SfTextBox>
				<ValidationMessage For="@(() => Item.FaxNumber)" />
			</div>
			<div class="form-row">
				<label>インボイス番号</label>
				<SfTextBox @bind-Value="Item.InvoiceNumber" Placeholder="インボイス番号"></SfTextBox>
				<ValidationMessage For="@(() => Item.InvoiceNumber)" />
			</div>
			</div>

			<h4>口座情報1</h4>
			<div class="form-section">
			<div class="form-row">
				<label class="required">銀行名</label>
				<SfTextBox @bind-Value="Item.Bank1Name" Placeholder="銀行名"></SfTextBox>
				<ValidationMessage For="@(() => Item.Bank1Name)" />
			</div>
			<div class="form-row">
				<label class="required">支店名</label>
				<SfTextBox @bind-Value="Item.Bank1BranchName" Placeholder="支店名"></SfTextBox>
				<ValidationMessage For="@(() => Item.Bank1BranchName)" />
			</div>
			<div class="form-row">
				<label class="required">口座種別</label>
				<SfDropDownList TValue="string" TItem="AccountType" 
					@bind-Value="@Item.Bank1AccountType" 
					DataSource="@AccountTypes"
					Placeholder="口座種別を選択"
					AllowFiltering="false">
					<DropDownListFieldSettings Value="Value" Text="Text">
					</DropDownListFieldSettings>
				</SfDropDownList>
				<ValidationMessage For="@(() => Item.Bank1AccountType)" />
			</div>
			<div class="form-row">
				<label class="required">口座番号</label>
				<SfTextBox @bind-Value="Item.Bank1AccountNumber" Placeholder="口座番号"></SfTextBox>
				<ValidationMessage For="@(() => Item.Bank1AccountNumber)" />
			</div>
			<div class="form-row">
				<label class="required">名義人</label>
				<SfTextBox @bind-Value="Item.Bank1AccountHolder" Placeholder="名義人"></SfTextBox>
				<ValidationMessage For="@(() => Item.Bank1AccountHolder)" />
			</div>
			</div>

			<h4>口座情報2</h4>
			<div class="form-section">
			<div class="form-row">
				<label>銀行名</label>
				<SfTextBox @bind-Value="Item.Bank2Name" Placeholder="銀行名"></SfTextBox>
				<ValidationMessage For="@(() => Item.Bank2Name)" />
			</div>
			<div class="form-row">
				<label>支店名</label>
				<SfTextBox @bind-Value="Item.Bank2BranchName" Placeholder="支店名"></SfTextBox>
				<ValidationMessage For="@(() => Item.Bank2BranchName)" />
			</div>
			<div class="form-row">
				<label>口座種別</label>
				<SfDropDownList TValue="string" TItem="AccountType" 
					@bind-Value="@Item.Bank2AccountType" 
					DataSource="@AccountTypes"
					Placeholder="口座種別を選択"
					AllowFiltering="false">
					<DropDownListFieldSettings Value="Value" Text="Text">
					</DropDownListFieldSettings>
				</SfDropDownList>
				<ValidationMessage For="@(() => Item.Bank2AccountType)" />
			</div>
			<div class="form-row">
				<label>口座番号</label>
				<SfTextBox @bind-Value="Item.Bank2AccountNumber" Placeholder="口座番号"></SfTextBox>
				<ValidationMessage For="@(() => Item.Bank2AccountNumber)" />
			</div>
			<div class="form-row">
				<label>名義人</label>
				<SfTextBox @bind-Value="Item.Bank2AccountHolder" Placeholder="名義人"></SfTextBox>
				<ValidationMessage For="@(() => Item.Bank2AccountHolder)" />
			</div>
			</div>

			<div class="form-buttons">
				<SfButton OnClick="OnRegister" IsPrimary="true">保存</SfButton>
				<SfButton OnClick="OnCancel">キャンセル</SfButton>
			</div>
		</div>
	</EditForm>

	@if (EmailSettings != null)
	{
		<div class="form">
			<h4>メール設定</h4>

			@if (!string.IsNullOrEmpty(EmailErrorMessage))
			{
				<div class="alert alert-danger">@EmailErrorMessage</div>
			}

			@if (!string.IsNullOrEmpty(EmailSuccessMessage))
			{
				<div class="alert alert-success">@EmailSuccessMessage</div>
			}

			<div class="form-section">
				<div class="form-row">
					<label class="required">SMTPホスト</label>
					<SfTextBox @bind-Value="@EmailSettings.SmtpHost" Placeholder="例: smtp.gmail.com"></SfTextBox>
				</div>
				<div class="form-row">
					<label class="required">SMTPポート</label>
					<SfNumericTextBox @bind-Value="@EmailSettings.SmtpPort" Min="1" Max="65535" Format="n0"></SfNumericTextBox>
				</div>
				<div class="form-row">
					<label>SSL/TLS使用</label>
					<SfCheckBox @bind-Checked="@EmailSettings.EnableSsl"></SfCheckBox>
				</div>
				<div class="form-row">
					<label class="required">送信者メールアドレス</label>
					<SfTextBox @bind-Value="@EmailSettings.SenderEmail" Placeholder="例: noreply@example.com"></SfTextBox>
				</div>
				<div class="form-row">
					<label>送信者名</label>
					<SfTextBox @bind-Value="@EmailSettings.SenderName" Placeholder="例: AutoDealerSphere"></SfTextBox>
				</div>
				<div class="form-row">
					<label class="required">SMTP認証ユーザー名</label>
					<SfTextBox @bind-Value="@EmailSettings.Username" Placeholder="SMTP認証用のユーザー名"></SfTextBox>
				</div>
				<div class="form-row">
					<label class="required">SMTP認証パスワード</label>
					<SfTextBox @bind-Value="@Password" Type="InputType.Password" Placeholder="SMTP認証用のパスワード"></SfTextBox>
				</div>
				<div class="form-row">
					<label>テストメール送信先</label>
					<SfTextBox @bind-Value="@TestEmailAddress" Placeholder="テストメールの送信先アドレス"></SfTextBox>
				</div>
			</div>

			<div class="form-buttons">
				<SfButton OnClick="OnSaveEmailSettings" IsPrimary="true" Disabled="@IsEmailProcessing">メール設定を保存</SfButton>
				<SfButton OnClick="OnTestConnection" Disabled="@IsEmailProcessing">接続テスト</SfButton>
				<SfButton OnClick="OnSendTestEmail" Disabled="@IsEmailProcessing">テストメール送信</SfButton>
			</div>
		</div>
	}
</div>