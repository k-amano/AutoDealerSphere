@page "/vehicle/{VehicleId:int}"
@inject NavigationManager NavigationManager
@inject HttpClient Http
@using Syncfusion.Blazor.DataForm
@using Syncfusion.Blazor.Buttons
@using System.ComponentModel.DataAnnotations
@using Syncfusion.Blazor.Navigations

<SfBreadcrumb>
    <BreadcrumbItems>
        <BreadcrumbItem IconCss="e-icons e-home" Url="/" />
        <BreadcrumbItem Text="車両管理" Url="/vehiclelist" />
        <BreadcrumbItem Text="編集" Url="./" />
    </BreadcrumbItems>
</SfBreadcrumb>

<h2>車両管理</h2>
<h3>編集</h3>

@* JSON Import Section *@
@if (_initialized && _item != null && VehicleId > 0)
{
    <div class="json-import-section">
        <h4>車検証json取り込み</h4>
        <div class="import-controls">
            <InputFile OnChange="@OnJsonFileSelected" accept=".json" />
            @if (!string.IsNullOrEmpty(selectedJsonFileName))
            {
                <span class="selected-file">選択ファイル: @selectedJsonFileName</span>
                <button class="btn btn-primary" @onclick="ImportJsonData" disabled="@isImporting">
                    @if (isImporting)
                    {
                        <span>取り込み中...</span>
                    }
                    else
                    {
                        <span>JSONデータを取り込む</span>
                    }
                </button>
            }
        </div>
        @if (!string.IsNullOrEmpty(importMessage))
        {
            <div class="import-message @(importSuccess ? "success" : "error")">
                @importMessage
            </div>
        }
    </div>
}

<h3>基本情報</h3>
@if (_initialized)
{
    @if (_item != null)
    {
        <VehicleForm Item="_item" Clients="_clients" VehicleCategories="_vehicleCategories" OnClickOK="OnClickOK" OnClickDelete="OnClickDelete" />
    }
    else
    {
        <p class="error-message">車両情報が見つかりません。</p>
    }
}

@code {
}